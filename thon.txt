from telethon.sync import TelegramClient
from telethon.tl.functions.messages import GetHistoryRequest

# Replace with your own values
api_id = 1234567
api_hash = 'your_api_hash_here'
phone = '+39 333 444 5555'  # your Telegram phone number

# Start client and sign in
client = TelegramClient('session_name', api_id, api_hash)

client.connect()
if not client.is_user_authorized():
    client.send_code_request(phone)
    client.sign_in(phone, input('Enter the code sent to your Telegram: '))

# Choose chat (can be a username, phone number, or ID)
target_username = 'username_of_sender'  # or exact name of person
entity = client.get_entity(target_username)

# Fetch latest message from the chat
history = client(GetHistoryRequest(
    peer=entity,
    limit=1,
    offset_date=None,
    offset_id=0,
    max_id=0,
    min_id=0,
    add_offset=0,
    hash=0
))

message = history.messages[0].message
print("Received message:")
print(message)
